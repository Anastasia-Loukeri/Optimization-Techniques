function [a_hist, b_hist, k_hist, N] = bisection_gradient_history(f_prime, a, b, l_target)

% Είσοδοι:
%   f_prime:   Function handle της ΠΡΩΤΗΣ παραγώγου f'(x).
%   a, b:      Όρια του αρχικού διαστήματος [a, b].
%   l_target:  Το επιθυμητό τελικό μήκος του διαστήματος (L_K <= l_target).

% Έξοδοι:
%   a_hist:    Ιστορικό των κάτω ορίων a_k.
%   b_hist:    Ιστορικό των άνω ορίων b_k.
%   k_hist:    Δείκτης επαναλήψεων k.
%   N:         Συνολικός αριθμός υπολογισμών f'(x).

    ak = a;
    bk = b;
    k = 0; % Δείκτης επαναλήψεων
    N = 0; % Μετρητής υπολογισμών παραγώγου
    
    % Αρχικοποίηση καταγραφής ιστορικού (k=0)
    a_hist = ak;
    b_hist = bk;
    k_hist = k;
    
    % Βρόχος Επανάληψης: Τερματίζει όταν το διάστημα είναι αρκετά μικρό.
    while (bk - ak) > l_target
        k = k + 1;
        
        % 1. Εύρεση του μέσου σημείου
        xm = (ak + bk) / 2;
        
        % 2. Υπολογισμός της παραγώγου στο μέσο σημείο 
        f_prime_xm = f_prime(xm);
        N = N + 1;
        
         
        
        % 4. Μείωση Διαστήματος
        if f_prime_xm < 0 % Το ελάχιστο είναι δεξιά (f' < 0 σημαίνει ότι f μειώνεται)
            ak = xm;
        
        else % f_prime_xm > 0 % Το ελάχιστο είναι αριστερά (f' > 0 σημαίνει ότι f αυξάνεται)
            bk = xm;
        end
        
        % Αποθήκευση ιστορικού για την τρέχουσα επανάληψη
        a_hist(end+1) = ak;
        b_hist(end+1) = bk;
        k_hist(end+1) = k;
    end
end